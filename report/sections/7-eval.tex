%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../report"
%%% End:
TODO:Present test methodology as well as results in this section. In addition, if performance
analysis of the system is interesting, present it here as well.
A few screenshots of the program can be included here as well. TODO



\subsection{Tests}

In the following we will describe the various tests we have performed in order to validate the correctness of the compiler, both throughout the development and of the final system.

We have made use of both \textbf{unit} and \textbf{integration} tests. Unit testing has been used on each of the modules of the compiler. For instance, we have tested the parser module in cases where the output of the lexer should yield a parse error and in cases where it should not.

TODO integration tests

\subsection{Optimization}
As our optimization pass removes unused function declarations from the parse tree, it is possible to achieve a substantial reduction of the emitted code.

A very simple program that concatenates the strings `Hello,' and ` World!' and prints them, is unoptimized emitted to 12.5kB of JavaScript, and optimized to 3.5kB. Thus optimization yields a size reduction of 72\%.

A slightly larger program that sums the even Fibonacci numbers less than 4 million (problem 2 of the online collection of mathematical problems Project Euler\cite{euler}) the compiler emits 12.9kB and 6.8kB of JavaScript without and with optimization, respectively. The program makes use of list comprehensions, which is just syntactic sugar for flatten and map, which then again uses a cascade of functions from Foundation.kite. Thus it is expected that a lot of the code from the library is used. But a reduction of 47\% is still noteworthy, and imagining the use of functions from other Kite-libraries for more specific purposes, this optimization might be useful. 


\begin{center}
  \begin{tabulary}{0.9\textwidth}{|L| L |L| C | L | }
    \hline
    Program & Size without optimization & Size with optimization & Percent reduction & Comment \\
    \hline
    Hello.kite       & 12.5 kB & 3.5 kB & 72 \% & A program that concatenates two strings prints the result \\
    & & & & \\
    Euler1 .kite       & 12.7 kB & 6.6 kB & 48 \% & A program that sums all numbers smaller than 1000 divisible by 3 or 5 \\
    & & & & \\
    Euler2 .kite       & 12.9 kB & 6.9 kB & 47 \% & A program that sums all even Fibonacci numbers less than four million \\
    & & & & \\
    Mandeltest.kite       & 15.1 kB & 8.3 kB & 45 \% & A program that plots the Mandelbrot fractal as animated ASCII art in the console\\
    \hline
  \end{tabulary}  

Above is a summation of the different Kite-programs we have made and optimized.
\end{center}

